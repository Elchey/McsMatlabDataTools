<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of plot</title>
  <meta name="keywords" content="plot">
  <meta name="description" content="Plot the contents of a McsSegmentStream object.">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../index.html">Home</a> &gt;  <a href="../index.html">+McsHDF5</a> &gt; <a href="index.html">@McsSegmentStream</a> &gt; plot.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../index.html"><img alt="<" border="0" src="../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for +McsHDF5/@McsSegmentStream&nbsp;<img alt=">" border="0" src="../../right.png"></a></td></tr></table>-->

<h1>plot
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>Plot the contents of a McsSegmentStream object.</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>function plot(segStream,cfg,varargin) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> Plot the contents of a McsSegmentStream object.

 function plot(segStream,cfg,varargin)

 Produces for each segment a 3D plot of trials x samples and a time series
 plot which overlays all trials.

 Input:

   segStream     -   A McsSegmentStream object

   cfg           -   Either empty (for default parameters) or a
                     structure with (some of) the following fields:
                     'segments': empty for all segments, otherwise a
                       vector of segment indices (default: all)
                     If fields are missing, their default values are used.

   Optional inputs in varargin are passed to the plot function.</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="plot.html" class="code" title="function plot(segStream,cfg,varargin)">plot</a>	Plot the contents of a McsSegmentStream object.</li></ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="plot.html" class="code" title="function plot(segStream,cfg,varargin)">plot</a>	Plot the contents of a McsSegmentStream object.</li></ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function plot(segStream,cfg,varargin)</a>
0002 <span class="comment">% Plot the contents of a McsSegmentStream object.</span>
0003 <span class="comment">%</span>
0004 <span class="comment">% function plot(segStream,cfg,varargin)</span>
0005 <span class="comment">%</span>
0006 <span class="comment">% Produces for each segment a 3D plot of trials x samples and a time series</span>
0007 <span class="comment">% plot which overlays all trials.</span>
0008 <span class="comment">%</span>
0009 <span class="comment">% Input:</span>
0010 <span class="comment">%</span>
0011 <span class="comment">%   segStream     -   A McsSegmentStream object</span>
0012 <span class="comment">%</span>
0013 <span class="comment">%   cfg           -   Either empty (for default parameters) or a</span>
0014 <span class="comment">%                     structure with (some of) the following fields:</span>
0015 <span class="comment">%                     'segments': empty for all segments, otherwise a</span>
0016 <span class="comment">%                       vector of segment indices (default: all)</span>
0017 <span class="comment">%                     If fields are missing, their default values are used.</span>
0018 <span class="comment">%</span>
0019 <span class="comment">%   Optional inputs in varargin are passed to the plot function.</span>
0020 
0021     clf
0022     
0023     <span class="keyword">if</span> isempty(cfg) || ~isfield(cfg,<span class="string">'segments'</span>)
0024         cfg.segments = [];
0025     <span class="keyword">end</span>
0026     
0027     <span class="keyword">if</span> isempty(cfg.segments)
0028         cfg.segments = 1:length(segStream.SegmentData);
0029     <span class="keyword">end</span>
0030     
0031     <span class="keyword">if</span> any(cfg.segments &lt; 1 | cfg.segments &gt; length(segStream.SegmentData))
0032         warning([<span class="string">'Using only segment indices between 1 and '</span> num2str(length(segStream.SegmentData)) <span class="string">'!'</span>])
0033         cfg.segments = cfg.segments(cfg.segments &gt;= 1 &amp; cfg.segments &lt;= length(segStream.SegmentData));
0034     <span class="keyword">end</span>
0035     
0036     <span class="keyword">for</span> segi = 1:length(cfg.segments)
0037         id = cfg.segments(segi);
0038         subplot(2,length(cfg.segments),segi);
0039         
0040         <span class="keyword">if</span> strcmp(segStream.DataType,<span class="string">'double'</span>)
0041             data_to_plot = segStream.SegmentData{id};
0042         <span class="keyword">else</span>
0043             conv_cfg = [];
0044             conv_cfg.dataType = <span class="string">'double'</span>;
0045             data_to_plot = segStream.getConvertedData(id,conv_cfg);
0046         <span class="keyword">end</span>
0047         
0048         orig_exp = log10(max(abs(data_to_plot(:))));
0049         sourceChan = str2double(segStream.Info.SourceChannelIDs{segi});
0050         <span class="keyword">if</span> length(sourceChan) &gt; 1
0051             warning(<span class="string">'Plots of multisegments are not yet supported!'</span>);
0052             <span class="keyword">return</span>;
0053         <span class="keyword">end</span>
0054         channel_idx = find(segStream.SourceInfoChannel.ChannelID == sourceChan);
0055         unit_exp = double(segStream.SourceInfoChannel.Exponent(channel_idx));
0056 
0057         [fact,unit_string] = McsHDF5.ExponentToUnit(orig_exp+unit_exp,orig_exp);
0058 
0059         data_to_plot = data_to_plot * fact;
0060         
0061         [X,Y] = meshgrid(1:size(data_to_plot,2),1:size(data_to_plot,1));
0062         <span class="keyword">if</span> isempty([varargin{:}])
0063             surfl(X,Y,data_to_plot);
0064         <span class="keyword">else</span>
0065             surfl(X,Y,data_to_plot,varargin{:});
0066         <span class="keyword">end</span>
0067         shading interp
0068         xlabel(<span class="string">'samples'</span>)
0069         ylabel(<span class="string">'events'</span>)
0070         unit = segStream.SourceInfoChannel.Unit{channel_idx};
0071         zlabel([unit_string unit],<span class="string">'Interpreter'</span>,<span class="string">'tex'</span>)
0072         title([<span class="string">'Segment label '</span> segStream.Info.Label{id}])
0073         
0074         
0075         subplot(2,length(cfg.segments),segi+length(cfg.segments));
0076         
0077         pre = double(segStream.Info.PreInterval(id));
0078         post = double(segStream.Info.PostInterval(id));
0079         ts = -pre:double(segStream.SourceInfoChannel.Tick(channel_idx)):post;
0080         <span class="keyword">if</span> length(ts) ~= size(data_to_plot,1)
0081             warning(<span class="string">'Pre- and post-interval does not match the number of samples!'</span>)
0082             ts = (1:size(data_to_plot,2)).*double(segStream.SourceInfoChannel.Tick(channel_idx));
0083         <span class="keyword">end</span>
0084         
0085         ts = McsHDF5.TickToSec(ts);
0086         <a href="plot.html" class="code" title="function plot(segStream,cfg,varargin)">plot</a>(ts,data_to_plot');
0087         
0088         hold on
0089         <a href="plot.html" class="code" title="function plot(segStream,cfg,varargin)">plot</a>(ts,mean(data_to_plot),<span class="string">'-k'</span>,<span class="string">'LineWidth'</span>,2);
0090         hold off
0091         
0092         axis tight
0093         xlabel(<span class="string">'Time [s]'</span>);
0094         ylabel([unit_string unit],<span class="string">'Interpreter'</span>,<span class="string">'tex'</span>)
0095         
0096     <span class="keyword">end</span>
0097 <span class="keyword">end</span>
0098</pre></div>
<hr><address>Generated on Wed 26-Mar-2014 15:28:34 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>